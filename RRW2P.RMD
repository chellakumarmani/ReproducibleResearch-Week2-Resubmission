---
title: "Reproducible Research Week 2 Project 1"
author: "M. Chellakumar"
date: "22 September 2018"
output: html_document
---
# Analysing data generated by a personal monitoring device
##Basic setting
```{r message=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)
library(magrittr)
```

## Loading and Preprocessing the data
```{r}
##Downloading data from the link
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", destfile = "activity.zip")

##Unzipping the data
unzip("activity.zip")

##Reading the data into R and naming the file as basedata
basedata<-read.csv("activity.csv")
head(basedata)


```

## 1.Calculate the total number of steps taken per day
```{r}
##Processing Data
steps_each_day<-basedata %>%
                group_by(date) %>%
                summarise(st=sum(steps))%>%
                na.omit()
hist(steps_each_day$st,xlab="Total Daily Steps",main= "Total Steps Taken Each Day",breaks=60)
```

## 2.Calculate and report the mean and median of the total number of steps taken per day

```{r}
summary(steps_each_day$st)
```

##3. Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r}
##Processig of data for timeseries
timeseries<-basedata%>%
            group_by(interval)%>%
            na.omit()%>%
            summarise(avgst=mean(steps))
##Now its time to plot
library(ggplot2)  
ggplot(timeseries,aes(x=interval,y=avgst))+geom_line()
```

##4. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r warning=FALSE,message=FALSE}
Interval_with_maxsteps<-basedata%>%
                        select(interval,steps)%>%
                        na.omit()%>%
                        group_by(interval)%>%
                        summarise(mst=mean(steps))%>%
                        arrange(desc(mst))%>%
                        slice(1:1)
###The 5 min interval, with max number of avg steps on all days
Interval_with_maxsteps
```

##5. Imputing missing values
### a) Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NA)

```{r}
sum(is.na(basedata))
```

There are 2304 rows with NA

### b) Devise a strategy for filling in all of the missing values in the dataset. 
Assuming the individual's behaviour to be the same during a particular  minute interval spread over 2 months,I will use the mean of the respective 5-minute interval.

### c) Create a new dataset that is equal to the original dataset but with the missing data filled in.
```{r}
replacewithmean<-function(x) replace(x,is.na(x),mean(x,na.rm = TRUE))
new_base_data<-basedata%>%
               group_by(interval) %>%
               mutate(steps= replacewithmean(steps))
```

Confirming that there are no NA values in the newly formed dataset
```{r}
sum(is.na(new_base_data))

```

### d) Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day. Do these values differ from the estimates from the first part of the assignment? What is the impact of imputing missing data on the estimates of the total daily number of steps?
```{r}
revised_steps_everyday<-new_base_data%>%
                        group_by(date)%>%
                        summarise(nst=sum(steps))

hist(revised_steps_everyday$nst,main="Total Daily Steps(revised",xlab="Steps",ylab="Frequency",breaks=30)
```

Now let's find out the impact of missing data on the estimates of daily number of steps between the old and new by finding out the difference between the mean and median
```{r}
mean(steps_each_day$st)-mean(revised_steps_everyday$nst)
median(steps_each_day$st)-median(revised_steps_everyday$nst)
```

While the mean remains the same, there is a slight increase in the median, in the newly imputed dataset.The same could be seen in the boxplot

```{r}
boxplot(steps_each_day$st,revised_steps_everyday$nst)
```

##6. Are there differences in activity patterns between weekdays and weekends?

```{r}
comp<-new_base_data %>%
      mutate(typeofday=ifelse(weekdays(as.Date(date))=="Saturday"
      |weekdays(as.Date(date))=="Sunday","Weekend","Weekdays"))%>%
      group_by(typeofday,interval) %>%
      summarise(mstp=mean(steps))

  ggplot(comp,aes(x=interval,y=mstp,col=comp$typeofday))+
  geom_line()+facet_grid(comp$typeofday~.)+
  xlab("Interval")+ylab("Avg Steps")+
  ggtitle("Comparison of avgsteps in each interval during weekdays and weekends")

```

There seems to be huge variation during the weekday's starting and weekend's starting. This could be attributed to due to activities like going to workplace, moving around during work etc
  
  
  
  

  
